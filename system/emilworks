--EmilWorks Version: 1.1 (for EmilOS)

function popupMsg(color, mode, title, text1, text2, text3, text4)
	if fs.exists("System/settings") then
		setFile = fs.open("System/settings","r")
		settings = textutils.unserialize(setFile.readAll())
		setFile.close()
	else
		settings = {}
		settings.background = "gray"
	end
	if not settings.background then
		settings.background = "gray"
	end
	if title == nil or title:len() >= 25 then
		clear()
		error("Error in title")
	end
	term.setBackgroundColor(colors[settings.background])
	term.clear()
	ynum = 0
	yc = 0
	if text2 ~= nil then
		ynum = ynum + 1
	end
	if text3 ~= nil then
		ynum = ynum + 1
	end
	if text4 ~= nil then
		ynum = ynum + 1
	end
	if mode ~= "3" then
		for i=1,5 + ynum do
			paintutils.drawLine(13,6 + yc,38,6 + yc,colors.white)
			yc = yc + 1
			paintutils.drawLine(14,11 + ynum,39,11 + ynum,colors.black)
			paintutils.drawLine(39,6,39,10 + ynum,colors.black)
		end
	else
		for i=1,3 + ynum do
			paintutils.drawLine(13,6 + yc,38,6 + yc,colors.white)
			yc = yc + 1
			paintutils.drawLine(14,9 + ynum, 39,9 + ynum,colors.black)
			paintutils.drawLine(39,6,39,9 + ynum,colors.black)
		end
	end
	if color ~= nil then
		paintutils.drawLine(13,5,38,5,color)
		term.setBackgroundColor(color)
	else
		clear()
		error("Color not specified")
	end
	term.setTextColor(colors.black)
	term.setCursorPos(14,5)
	print(title)
	term.setCursorPos(14,7)
	term.setBackgroundColor(colors.white)
	print(text1)
	if text2 ~= nil then
		term.setCursorPos(14,8)
		print(text2)
	end
	if text3 ~= nil then
		term.setCursorPos(14,9)
		print(text3)
	end
	if text4 ~= nil then
		term.setCursorPos(14,10)
		print(text4)
	end
	if mode == "1" then
		paintutils.drawLine(32,9 + ynum,37,9 + ynum,colors.lightGray)
		term.setCursorPos(34,9 + ynum)
		term.setTextColor(colors.black)
		print("OK")
		while true do
			local e, but, cx, cy = os.pullEvent("mouse_click")
			if cx >= 32 and cx <= 37 and cy == 9 + ynum then
				break
			end
		end
	elseif mode == "2" then
		paintutils.drawLine(14,9 + ynum,23,9 + ynum,colors.lightGray)
		paintutils.drawLine(32,9 + ynum,37,9 + ynum,colors.lightGray)
		term.setTextColor(colors.black)
		term.setCursorPos(16,9 + ynum)
		print("Cancel")
		term.setCursorPos(34,9 + ynum)
		print("OK")
		while true do
			local e, but, cx, cy = os.pullEvent("mouse_click")
			if cx >= 14 and cx <= 23 and cy == 9 + ynum then
				return false
			elseif cx >= 32 and cx <= 37 and cy == 9 + ynum then
				return true
			end
		end
	elseif mode == "3" then
		term.setBackgroundColor(colors.black)
		term.setTextColor(colors.white)
		term.setCursorPos(1,1)
	elseif mode == "4" then
		paintutils.drawLine(14,9 + ynum,37,9 + ynum,colors.lightGray)
		term.setCursorPos(15,9 + ynum)
		return io.read()
	elseif mode == "5" then
		paintutils.drawLine(14,9 + ynum,37,9 + ynum,colors.lightGray)
		term.setCursorPos(15,9 + ynum)
		return read("*")
	elseif mode == "6" then
		paintutils.drawLine(14,9 + ynum,19,9 + ynum,colors.lightGray)
		paintutils.drawLine(31,9 + ynum,37,9 + ynum,colors.lightGray)
		term.setCursorPos(16,9 + ynum)
		print("Ja")
		term.setCursorPos(33,9 + ynum)
		print("Nej")
		while true do
			local e, but, cx, cy = os.pullEvent("mouse_click")
			if cx >= 14 and cx <= 20 and cy == 9 + ynum then
				return true
			elseif cx >= 32 and cx <= 37 and cy == 9 + ynum then
				return false
			end
		end
	else
		clear()
		error("Error in Mode")
	end
end
function hash(string)
	os.loadAPI("System/sha")
	hash = sha.sha256(string)
	os.unloadAPI("sha")
	return hash
end